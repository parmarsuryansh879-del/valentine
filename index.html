<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Will You be my Valentine?</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&amp;family=Great+Vibes&amp;family=Cormorant+Garamond:wght@400;600&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    .font-script { font-family: 'Great Vibes', cursive; }
    .font-serif { font-family: 'Crimson Text', serif; }
    .font-elegant { font-family: 'Cormorant Garamond', serif; }
    
    .page { display: none; }
    .page.active { display: flex; }
    
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-15px) rotate(3deg); }
    }
    
    @keyframes envelopeShake {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }
    
    @keyframes envelopeOpen {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(-180deg); }
    }
    
    @keyframes letterSlideUp {
      0% { transform: translateY(150px) scale(0.8); opacity: 0; }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }
    
    .envelope-flap-open {
      animation: envelopeOpen 0.8s ease-out forwards;
      transform-origin: top center;
    }
    
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes heartPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
      50% { opacity: 1; transform: scale(1) rotate(180deg); }
    }
    
    .envelope-hover:hover {
      animation: envelopeShake 0.5s ease-in-out;
    }
    
    .letter-appear {
      animation: letterSlideUp 0.8s ease-out forwards;
    }
    
    .fade-in {
      animation: fadeIn 0.6s ease-out forwards;
    }
    
    .heart-pulse {
      animation: heartPulse 1.5s ease-in-out infinite;
    }
    
    .sparkle-anim {
      animation: sparkle 2s ease-in-out infinite;
    }
    
    /* Memory game cards */
    .memory-card {
      perspective: 1000px;
      cursor: pointer;
    }
    
    .memory-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    
    .memory-card.flipped .memory-card-inner {
      transform: rotateY(180deg);
    }
    
    .memory-card-front, .memory-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
    }
    
    .memory-card-back {
      transform: rotateY(180deg);
    }
    
    .photo-placeholder {
      background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
      border: 3px dashed #ec4899;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ec4899;
      font-weight: 600;
    }
    
    @keyframes ringShine {
      0%, 100% { filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5)); }
      50% { filter: drop-shadow(0 0 25px rgba(251, 191, 36, 0.9)); }
    }
    
    .ring-shine {
      animation: ringShine 2s ease-in-out infinite;
    }
    
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      pointer-events: none;
      z-index: 100;
    }
    
    @keyframes confettiFall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    @keyframes heartsRise {
      0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(360deg) scale(1.2); opacity: 0; }
    }
    
    @keyframes glow {
      0%, 100% { 
        text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
        filter: brightness(1);
      }
      50% { 
        text-shadow: 0 0 20px currentColor, 0 0 40px currentColor, 0 0 60px currentColor, 0 0 80px currentColor;
        filter: brightness(1.3);
      }
    }
    
    @keyframes glowPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(236, 72, 153, 0.5), 0 0 40px rgba(236, 72, 153, 0.3); }
      50% { box-shadow: 0 0 40px rgba(236, 72, 153, 0.8), 0 0 80px rgba(236, 72, 153, 0.5), 0 0 120px rgba(236, 72, 153, 0.3); }
    }
    
    .glow-text {
      animation: glow 2s ease-in-out infinite;
    }
    
    .glow-box {
      animation: glowPulse 2s ease-in-out infinite;
    }
    
    @keyframes hearts {
      0% { transform: translateY(0) scale(0); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translateY(-100px) scale(1); opacity: 0; }
    }
   /* ===== FIXED PHOTO GALLERY (SAFE PATCH) ===== */
.photo-box {
  width: 100%;
  aspect-ratio: 4 / 3;
  overflow: hidden;
  border-radius: 16px;
  background: #ffffff;
}

.photo-box img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  image-orientation: from-image;
  display: block;
}
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto"><!-- Page 1: Envelope -->
   <div id="page1" class="page active min-h-full w-full flex flex-col items-center justify-center p-6">
    <div class="text-center mb-8 fade-in">
     <h1 class="font-script text-6xl mb-4 glow-text" id="page1-title">For My Goddess</h1>
     <p class="font-serif text-xl opacity-80" id="page1-subtitle">Something magical awaits you...</p>
    </div>
    <div class="envelope-hover cursor-pointer" id="envelope" onclick="openEnvelope()">
     <svg width="280" height="200" viewbox="0 0 280 200"><defs>
       <lineargradient id="envelopeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#fdf2f8" />
        <stop offset="100%" style="stop-color:#fce7f3" />
       </lineargradient>
      </defs> <!-- Envelope body --> <rect x="20" y="60" width="240" height="130" fill="url(#envelopeGrad)" stroke="#ec4899" stroke-width="3" rx="8" /> <!-- Envelope flap --> <g id="envelope-flap" style="transform-origin: 140px 60px;">
       <path d="M 20 60 L 140 120 L 260 60" fill="#fbcfe8" stroke="#ec4899" stroke-width="3" /> <!-- Heart seal -->
       <circle cx="140" cy="125" r="20" fill="#fff" opacity="0.9" />
       <path d="M 140 135 l -8 -8 c -4 -4 -4 -10 0 -14 c 4 -4 10 -4 14 0 l 2 2 l 2 -2 c 4 -4 10 -4 14 0 c 4 4 4 10 0 14 l -8 8 l -8 8 z" fill="#ec4899" />
      </g>
     </svg>
    </div>
    <p class="mt-8 font-serif text-lg animate-pulse" id="page1-prompt">Click the envelope to open üíå</p>
   </div><!-- Page 2: Love Letter -->
   <div id="page2" class="page min-h-full w-full flex flex-col items-center justify-center p-6">
    <div class="max-w-2xl w-full rounded-2xl shadow-2xl p-8 md:p-12 letter-appear" id="letter-container">
     <div class="text-center mb-8">
      <div class="inline-block mb-4">
       <svg width="60" height="60" viewbox="0 0 24 24" class="heart-pulse"><path fill="#ec4899" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
       </svg>
      </div>
      <h2 class="font-script text-5xl mb-2" id="letter-greeting">My Dearest Love</h2>
     </div>
     <div class="space-y-6">
      <p class="font-serif text-lg leading-relaxed" id="letter-message">From the moment I met you, my world became brighter. Your smile lights up my darkest days, your laughter is my favorite melody, and your love is my greatest treasure. Every second with you feels like a beautiful dream I never want to wake up from.</p>
      <p class="font-serif text-lg leading-relaxed">You've shown me what true love means - it's in the little moments, the quiet conversations, the shared dreams, and the way you hold my hand through everything.</p>
      <p class="font-serif text-lg leading-relaxed italic">I have something special to show you... Keep going to discover our beautiful journey together.     </p>
     </div>
     <div class="mt-10 text-center"><button onclick="nextPage()" class="font-serif px-8 py-4 rounded-full shadow-lg hover:shadow-xl transition-all text-lg font-semibold" id="letter-button"> Continue Our Story ‚Üí </button>
     </div>
    </div>
   </div><!-- Page 3: Memory Game -->
   <div id="page3" class="page min-h-full w-full flex flex-col items-center justify-center p-6">
    <div class="max-w-4xl w-full">
     <div class="text-center mb-8 fade-in">
      <h2 class="font-script text-5xl mb-4" id="page3-title">Our Love Story</h2>
      <p class="font-serif text-xl mb-2" id="page3-subtitle">Match the hearts to reveal our precious memories</p>
      <p class="font-elegant text-lg opacity-80">Matches: <span id="match-count">0</span>/6</p>
     </div>
     <div class="grid grid-cols-3 md:grid-cols-4 gap-4 mb-8" id="memory-game"><!-- Cards will be generated by JavaScript -->
     </div>
     <div class="text-center"><button onclick="nextPage()" class="font-serif px-8 py-4 rounded-full shadow-lg hover:shadow-xl transition-all text-lg font-semibold opacity-50 pointer-events-none" id="game-continue-btn"> Continue to Memories ‚Üí </button>
     </div>
    </div>
<!-- Page 4: Photo Gallery -->
<div id="page4" class="page min-h-full w-full flex flex-col items-center justify-center p-6">
  <div class="max-w-5xl w-full">

    <div class="text-center mb-12 fade-in">
      <h2 class="font-script text-5xl mb-4" id="page4-title">Our Beautiful Moments</h2>
      <p class="font-serif text-xl opacity-80" id="page4-subtitle">Every moment with you is a treasure</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">

      <!-- PHOTO 1 -->
      <div class="rounded-2xl shadow-xl overflow-hidden fade-in" style="animation-delay: 0.1s;">
        <div class="photo-box">
          <img src="./images/IMG-20250914-WA0072.jpg" alt="Photo 1">
        </div>
        <div class="p-6" id="photo1-caption-container">
          <p class="font-elegant text-xl text-center" id="photo1-caption">
            Our first date - the moment I knew you were special
          </p>
        </div>
      </div>

      <!-- PHOTO 2 -->
      <div class="rounded-2xl shadow-xl overflow-hidden fade-in" style="animation-delay: 0.2s;">
        <div class="photo-box">
          <img src="./images/IMG-20251103-WA0066.jpg" alt="Photo 2">
        </div>
        <div class="p-6" id="photo2-caption-container">
          <p class="font-elegant text-xl text-center" id="photo2-caption">
            The day I realized I was falling in love
          </p>
        </div>
      </div>

      <!-- PHOTO 3 -->
      <div class="rounded-2xl shadow-xl overflow-hidden fade-in" style="animation-delay: 0.3s;">
        <div class="photo-box">
          <img src="./images/IMG-20251227-WA0031.jpg" alt="Photo 3">
        </div>
        <div class="p-6" id="photo3-caption-container">
          <p class="font-elegant text-xl text-center" id="photo3-caption">
            My favorite moment - your smile that day was everything
          </p>
        </div>
      </div>

      <!-- PHOTO 4 -->
      <div class="rounded-2xl shadow-xl overflow-hidden fade-in" style="animation-delay: 0.4s;">
        <div class="photo-box">
          <img src="./images/IMG_20251031_085631_262.jpg" alt="Photo 4">
        </div>
        <div class="p-6" id="photo4-caption-container">
          <p class="font-elegant text-xl text-center" id="photo4-caption">
            Together forever - this is just the beginning
          </p>
        </div>
      </div>

    </div>

    <div class="text-center">
      <button onclick="nextPage()" class="font-serif px-8 py-4 rounded-full shadow-lg hover:shadow-xl transition-all text-lg font-semibold" id="gallery-button">
        One More Thing... üíç
      </button>
    </div>

  </div>
</div>

   </div><!-- Page 5: Proposal -->
   <div id="page5" class="page min-h-full w-full flex flex-col items-center justify-center p-6">
    <div class="max-w-2xl w-full text-center">
     <div class="mb-8 ring-shine glow-box">
      <svg width="140" height="140" viewbox="0 0 120 120" class="mx-auto"><defs>
        <radialgradient id="diamondGrad">
         <stop offset="0%" style="stop-color:#fef3c7" />
         <stop offset="100%" style="stop-color:#fbbf24" />
        </radialgradient>
       </defs> <!-- Ring band --> <ellipse cx="60" cy="80" rx="35" ry="8" fill="#d4d4d4" /> <rect x="25" y="72" width="70" height="16" rx="8" fill="#e5e5e5" /> <!-- Diamond --> <path d="M 60 30 L 50 50 L 60 65 L 70 50 Z" fill="url(#diamondGrad)" stroke="#fbbf24" stroke-width="2" /> <path d="M 45 50 L 60 30 L 75 50 L 60 65 Z" fill="#fef3c7" opacity="0.7" /> <!-- Sparkles --> <circle cx="45" cy="35" r="2" fill="#fbbf24" class="sparkle-anim" /> <circle cx="75" cy="40" r="2" fill="#fbbf24" class="sparkle-anim" style="animation-delay: 0.3s;" /> <circle cx="55" cy="25" r="2" fill="#fbbf24" class="sparkle-anim" style="animation-delay: 0.6s;" />
      </svg>
     </div>
     <div class="mb-8 space-y-6">
      <h2 class="font-script text-5xl glow-text" id="proposal-name">Saumya</h2>
      <p class="font-serif text-xl leading-relaxed" id="proposal-message">You are a radiant goddess who lights up my world with every smile. Your grace, your beauty, your spirit - everything about you is absolutely divine. Being near you feels like magic, and every moment with you is a blessing I treasure beyond words.</p>
     </div>
     <div class="mb-12">
      <h1 class="font-script text-6xl md:text-7xl mb-8 heart-pulse glow-text" id="proposal-question">Will You Be My Valentine?</h1>
     </div>
     <div class="flex gap-6 justify-center items-center flex-wrap"><button onclick="handleResponse('yes')" class="font-serif px-12 py-6 rounded-full shadow-2xl hover:shadow-3xl transition-all text-2xl font-bold glow-box" id="yes-button"> YES! üíñ </button> <button onmouseenter="runAway(event)" class="font-serif px-12 py-6 rounded-full shadow-lg hover:shadow-xl transition-all text-xl" id="thinking-button" style="position: relative;"> Let me think... </button>
     </div>
     <div id="response-container" class="mt-12 hidden">
      <div class="rounded-2xl p-8 shadow-xl" id="response-box">
       <p class="font-script text-4xl mb-4" id="response-text"></p>
       <p class="font-serif text-xl" id="response-subtext"></p>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      her_name: "Saumya",
      envelope_text: "Click to open my heart",
      letter_opening: "My Dearest Goddess",
      letter_message: "From the moment I met you, my world became brighter. Your smile lights up my darkest days, your laughter is my favorite melody, and your love is my greatest treasure. Every second with you feels like a beautiful dream I never want to wake up from.",
      photo1_caption: "Our first date - the moment I knew you were special",
      photo2_caption: "The day I realized I was falling in love",
      photo3_caption: "My favorite moment - your smile that day was everything",
      photo4_caption: "Together forever - this is just the beginning",
      proposal_message: "You are a radiant goddess who lights up my world with every smile. Your grace, your beauty, your spirit - everything about you is absolutely divine. Being near you feels like magic, and every moment with you is a blessing I treasure beyond words.",
      proposal_question: "Will You Be My Valentine?",
      background_color: "#fdf4ff",
      card_color: "#ffffff",
      primary_color: "#ec4899",
      text_color: "#831843",
      accent_color: "#fbcfe8",
      font_family: "Crimson Text",
      font_size: 16
    };

    let config = { ...defaultConfig };
    let currentPage = 1;
    let matchedPairs = 0;
    let flippedCards = [];
    let canFlip = true;

    // Memory game setup
    const heartEmojis = ['üíï', 'üíñ', 'üíó', 'üíù', 'üíò', '‚ù§Ô∏è'];
    let gameCards = [...heartEmojis, ...heartEmojis].sort(() => Math.random() - 0.5);

    function initMemoryGame() {
      const gameContainer = document.getElementById('memory-game');
      gameContainer.innerHTML = '';
      gameCards.forEach((emoji, index) => {
        const card = document.createElement('div');
        card.className = 'memory-card aspect-square';
        card.dataset.emoji = emoji;
        card.dataset.index = index;
        card.innerHTML = `
          <div class="memory-card-inner">
            <div class="memory-card-front" style="background: linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color} 0%, ${config.accent_color || defaultConfig.accent_color} 100%);">
              <span class="text-4xl">‚ùî</span>
            </div>
            <div class="memory-card-back" style="background: ${config.card_color || defaultConfig.card_color}; border: 3px solid ${config.primary_color || defaultConfig.primary_color};">
              <span class="text-5xl">${emoji}</span>
            </div>
          </div>
        `;
        card.onclick = () => flipCard(card);
        gameContainer.appendChild(card);
      });
    }

    function flipCard(card) {
      if (!canFlip || card.classList.contains('flipped') || flippedCards.length >= 2) return;
      
      card.classList.add('flipped');
      flippedCards.push(card);
      
      if (flippedCards.length === 2) {
        canFlip = false;
        const [card1, card2] = flippedCards;
        
        if (card1.dataset.emoji === card2.dataset.emoji) {
          matchedPairs++;
          document.getElementById('match-count').textContent = matchedPairs;
          flippedCards = [];
          canFlip = true;
          
          if (matchedPairs === 6) {
            setTimeout(() => {
              const btn = document.getElementById('game-continue-btn');
              btn.classList.remove('opacity-50', 'pointer-events-none');
              createRisingHearts();
            }, 500);
          }
        } else {
          setTimeout(() => {
            card1.classList.remove('flipped');
            card2.classList.remove('flipped');
            flippedCards = [];
            canFlip = true;
          }, 1000);
        }
      }
    }

    function createConfetti() {
      const colors = ['#ec4899', '#fbbf24', '#f43f5e', '#a855f7', '#3b82f6', '#10b981'];
      const shapes = ['üíñ', 'üíï', 'üíó', 'üíù', '‚ú®', '‚≠ê', 'üí´'];
      
      for (let i = 0; i < 80; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.top = '-50px';
          
          // Mix of colored squares and emoji hearts
          if (Math.random() > 0.5) {
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.width = (8 + Math.random() * 8) + 'px';
            confetti.style.height = confetti.style.width;
          } else {
            confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
            confetti.style.fontSize = (16 + Math.random() * 12) + 'px';
          }
          
          confetti.style.animation = `confettiFall ${2 + Math.random() * 3}s linear forwards`;
          document.body.appendChild(confetti);
          setTimeout(() => confetti.remove(), 5000);
        }, i * 20);
      }
    }
    
    function createRisingHearts() {
      const hearts = ['üíï', 'üíñ', 'üíó', 'üíù', 'üíò', '‚ù§Ô∏è', 'üíì', 'üíû'];
      
      for (let i = 0; i < 60; i++) {
        setTimeout(() => {
          const heart = document.createElement('div');
          heart.className = 'confetti';
          heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
          heart.style.left = Math.random() * 100 + '%';
          heart.style.bottom = '-50px';
          heart.style.fontSize = (20 + Math.random() * 20) + 'px';
          heart.style.animation = `heartsRise ${3 + Math.random() * 2}s ease-out forwards`;
          document.body.appendChild(heart);
          setTimeout(() => heart.remove(), 6000);
        }, i * 30);
      }
    }

    function openEnvelope() {
      // Animate the envelope flap opening
      const flap = document.getElementById('envelope-flap');
      flap.classList.add('envelope-flap-open');
      
      // After animation, transition to letter page
      setTimeout(() => {
        currentPage = 2;
        updatePages();
      }, 1000);
    }

    function nextPage() {
      currentPage++;
      if (currentPage === 3) {
        setTimeout(() => initMemoryGame(), 100);
      }
      updatePages();
    }

    function updatePages() {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      const nextPageElement = document.getElementById(`page${currentPage}`);
      nextPageElement.classList.add('active');
      
      // Scroll to top smoothly
      nextPageElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function runAway(event) {
      const button = event.target;
      const container = button.parentElement;
      const containerRect = container.getBoundingClientRect();
      const buttonRect = button.getBoundingClientRect();
      
      // Calculate random position within viewport
      const maxX = window.innerWidth - buttonRect.width - 40;
      const maxY = window.innerHeight - buttonRect.height - 40;
      
      const randomX = Math.random() * maxX;
      const randomY = Math.random() * maxY;
      
      button.style.position = 'fixed';
      button.style.left = randomX + 'px';
      button.style.top = randomY + 'px';
      button.style.zIndex = '1000';
      
      // Create hearts at old position
      createFloatingHearts(buttonRect.left + buttonRect.width / 2, buttonRect.top + buttonRect.height / 2);
    }
    
    function createFloatingHearts(x, y) {
      const hearts = ['üíï', 'üíñ', 'üíó', 'üíù', 'üíò'];
      for (let i = 0; i < 5; i++) {
        const heart = document.createElement('div');
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.position = 'fixed';
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        heart.style.fontSize = '24px';
        heart.style.pointerEvents = 'none';
        heart.style.zIndex = '999';
        heart.style.animation = 'hearts 2s ease-out forwards';
        heart.style.animationDelay = (i * 0.1) + 's';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 2000);
      }
    }
    
    function handleResponse(response) {
      const container = document.getElementById('response-container');
      const responseText = document.getElementById('response-text');
      const responseSubtext = document.getElementById('response-subtext');
      const responseBox = document.getElementById('response-box');
      
      container.classList.remove('hidden');
      
      if (response === 'yes') {
        responseText.textContent = 'üíñ You said YES! üíñ';
        responseSubtext.textContent = 'You\'ve just made me the happiest person alive! You\'re my Valentine forever!';
        responseBox.style.background = `linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color}20 0%, ${config.accent_color || defaultConfig.accent_color}40 100%)`;
        responseBox.style.border = `3px solid ${config.primary_color || defaultConfig.primary_color}`;
        
        // Massive confetti celebration!
        createConfetti();
        setTimeout(createConfetti, 500);
        setTimeout(createConfetti, 1000);
        setTimeout(createConfetti, 1500);
        setTimeout(createConfetti, 2000);
        setTimeout(createConfetti, 2500);
        
        // Hide the thinking button
        document.getElementById('thinking-button').style.display = 'none';
      }
    }

    async function onConfigChange(cfg) {
      const font = cfg.font_family || defaultConfig.font_family;
      const baseSize = cfg.font_size || defaultConfig.font_size;
      const bgColor = cfg.background_color || defaultConfig.background_color;
      const primaryColor = cfg.primary_color || defaultConfig.primary_color;
      const textColor = cfg.text_color || defaultConfig.text_color;
      const cardColor = cfg.card_color || defaultConfig.card_color;
      const accentColor = cfg.accent_color || defaultConfig.accent_color;
      
      // Update all pages background
      const pages = document.querySelectorAll('.page');
      pages.forEach(page => {
        page.style.background = `linear-gradient(135deg, ${bgColor} 0%, ${accentColor} 100%)`;
      });
      
      // Page 1
      document.getElementById('page1-title').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('page1-title').style.color = primaryColor;
      document.getElementById('page1-title').style.fontSize = `${baseSize * 3.75}px`;
      
      document.getElementById('page1-subtitle').style.fontFamily = `${font}, serif`;
      document.getElementById('page1-subtitle').style.color = textColor;
      document.getElementById('page1-subtitle').style.fontSize = `${baseSize * 1.25}px`;
      
      document.getElementById('page1-prompt').style.fontFamily = `${font}, serif`;
      document.getElementById('page1-prompt').style.color = textColor;
      document.getElementById('page1-prompt').style.fontSize = `${baseSize * 1.125}px`;
      
      // Page 2
      const letterContainer = document.getElementById('letter-container');
      letterContainer.style.backgroundColor = cardColor;
      letterContainer.style.border = `2px solid ${accentColor}`;
      
      document.getElementById('letter-greeting').textContent = cfg.letter_opening || defaultConfig.letter_opening;
      document.getElementById('letter-greeting').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('letter-greeting').style.color = primaryColor;
      document.getElementById('letter-greeting').style.fontSize = `${baseSize * 3.125}px`;
      
      document.getElementById('letter-message').textContent = cfg.letter_message || defaultConfig.letter_message;
      document.getElementById('letter-message').style.fontFamily = `${font}, serif`;
      document.getElementById('letter-message').style.color = textColor;
      document.getElementById('letter-message').style.fontSize = `${baseSize * 1.125}px`;
      
      const letterButton = document.getElementById('letter-button');
      letterButton.style.backgroundColor = primaryColor;
      letterButton.style.color = '#ffffff';
      letterButton.style.fontSize = `${baseSize * 1.125}px`;
      
      // Page 3
      document.getElementById('page3-title').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('page3-title').style.color = primaryColor;
      document.getElementById('page3-title').style.fontSize = `${baseSize * 3.125}px`;
      
      document.getElementById('page3-subtitle').style.fontFamily = `${font}, serif`;
      document.getElementById('page3-subtitle').style.color = textColor;
      document.getElementById('page3-subtitle').style.fontSize = `${baseSize * 1.25}px`;
      
      const gameContinueBtn = document.getElementById('game-continue-btn');
      gameContinueBtn.style.backgroundColor = primaryColor;
      gameContinueBtn.style.color = '#ffffff';
      gameContinueBtn.style.fontSize = `${baseSize * 1.125}px`;
      
      // Page 4
      document.getElementById('page4-title').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('page4-title').style.color = primaryColor;
      document.getElementById('page4-title').style.fontSize = `${baseSize * 3.125}px`;
      
      document.getElementById('page4-subtitle').style.fontFamily = `${font}, serif`;
      document.getElementById('page4-subtitle').style.color = textColor;
      document.getElementById('page4-subtitle').style.fontSize = `${baseSize * 1.25}px`;
      
      // Photo captions
      ['photo1', 'photo2', 'photo3', 'photo4'].forEach(photoId => {
        const captionContainer = document.getElementById(`${photoId}-caption-container`);
        captionContainer.style.backgroundColor = cardColor;
        
        const caption = document.getElementById(`${photoId}-caption`);
        const configKey = `${photoId}_caption`;
        caption.textContent = cfg[configKey] || defaultConfig[configKey];
        caption.style.fontFamily = `'Cormorant Garamond', ${font}, serif`;
        caption.style.color = textColor;
        caption.style.fontSize = `${baseSize * 1.25}px`;
      });
      
      const galleryButton = document.getElementById('gallery-button');
      galleryButton.style.backgroundColor = primaryColor;
      galleryButton.style.color = '#ffffff';
      galleryButton.style.fontSize = `${baseSize * 1.125}px`;
      
      // Page 5
      document.getElementById('proposal-name').textContent = cfg.her_name || defaultConfig.her_name;
      document.getElementById('proposal-name').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('proposal-name').style.color = primaryColor;
      document.getElementById('proposal-name').style.fontSize = `${baseSize * 2.5}px`;
      
      document.getElementById('proposal-message').textContent = cfg.proposal_message || defaultConfig.proposal_message;
      document.getElementById('proposal-message').style.fontFamily = `${font}, serif`;
      document.getElementById('proposal-message').style.color = textColor;
      document.getElementById('proposal-message').style.fontSize = `${baseSize * 1.25}px`;
      
      document.getElementById('proposal-question').textContent = cfg.proposal_question || defaultConfig.proposal_question;
      document.getElementById('proposal-question').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('proposal-question').style.color = primaryColor;
      document.getElementById('proposal-question').style.fontSize = `${baseSize * 4.375}px`;
      
      const yesButton = document.getElementById('yes-button');
      yesButton.style.backgroundColor = primaryColor;
      yesButton.style.color = '#ffffff';
      yesButton.style.fontSize = `${baseSize * 1.5}px`;
      
      const thinkingButton = document.getElementById('thinking-button');
      thinkingButton.style.backgroundColor = accentColor;
      thinkingButton.style.color = textColor;
      thinkingButton.style.fontSize = `${baseSize * 1.25}px`;
      
      document.getElementById('response-text').style.fontFamily = `'Great Vibes', ${font}, cursive`;
      document.getElementById('response-text').style.color = primaryColor;
      document.getElementById('response-text').style.fontSize = `${baseSize * 2.5}px`;
      
      document.getElementById('response-subtext').style.fontFamily = `${font}, serif`;
      document.getElementById('response-subtext').style.color = textColor;
      document.getElementById('response-subtext').style.fontSize = `${baseSize * 1.25}px`;
    }

    function mapToCapabilities(cfg) {
      return {
        recolorables: [
          {
            get: () => cfg.background_color || defaultConfig.background_color,
            set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
          },
          {
            get: () => cfg.card_color || defaultConfig.card_color,
            set: (v) => { cfg.card_color = v; window.elementSdk.setConfig({ card_color: v }); }
          },
          {
            get: () => cfg.primary_color || defaultConfig.primary_color,
            set: (v) => { cfg.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
          },
          {
            get: () => cfg.text_color || defaultConfig.text_color,
            set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
          },
          {
            get: () => cfg.accent_color || defaultConfig.accent_color,
            set: (v) => { cfg.accent_color = v; window.elementSdk.setConfig({ accent_color: v }); }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => cfg.font_family || defaultConfig.font_family,
          set: (v) => { cfg.font_family = v; window.elementSdk.setConfig({ font_family: v }); }
        },
        fontSizeable: {
          get: () => cfg.font_size || defaultConfig.font_size,
          set: (v) => { cfg.font_size = v; window.elementSdk.setConfig({ font_size: v }); }
        }
      };
    }

    function mapToEditPanelValues(cfg) {
      return new Map([
        ["her_name", cfg.her_name || defaultConfig.her_name],
        ["envelope_text", cfg.envelope_text || defaultConfig.envelope_text],
        ["letter_opening", cfg.letter_opening || defaultConfig.letter_opening],
        ["letter_message", cfg.letter_message || defaultConfig.letter_message],
        ["photo1_caption", cfg.photo1_caption || defaultConfig.photo1_caption],
        ["photo2_caption", cfg.photo2_caption || defaultConfig.photo2_caption],
        ["photo3_caption", cfg.photo3_caption || defaultConfig.photo3_caption],
        ["photo4_caption", cfg.photo4_caption || defaultConfig.photo4_caption],
        ["proposal_message", cfg.proposal_message || defaultConfig.proposal_message],
        ["proposal_question", cfg.proposal_question || defaultConfig.proposal_question]
      ]);
    }

    // Initialize SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
      config = window.elementSdk.config || config;
    }
    
    // Initial render
    onConfigChange(config);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c0e6e5cf2653f7f',t:'MTc2ODkxMDYzMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>


